<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utwórz konto · KCW</title>
    <link rel="stylesheet" href="{{ url_for('static', path='css/styles.css') }}">
</head>
<body class="auth-body">
<main class="auth-container" aria-labelledby="register-title">
<a class="auth-logo" href="/" aria-label="Strona główna">
    <img src="https://mlodziez.krakow.pl/wp-content/themes/simple-bootstrap/images/mk20.svg" alt="Strona główna" style="width:128px;height:128px;"></a>

    {% if error %}
        <div class="flash flash-error" role="alert">{{ error }}</div>
    {% endif %}

    <section class="auth-card">
        <h1 id="register-title">Utwórz konto wolontariusza</h1>
        <form method="post" action="/register" class="auth-form">
            <div class="form-group">
                <label for="user_type">Rola</label>
                <select id="user_type" class="form-control" name="user_type" required>
                      <option value="">--Wskaż kim jesteś--</option>
                      <option value="volunteer">Wolontariusz</option>
                      <option value="coordinator">Koordynator</option>
                </select>
            </div>
            <div class="form-group">
                <label for="email">Adres email</label>
                <input type="email" id="email" name="email" class="form-control" value="{{ email or '' }}" required autocomplete="email">
            </div>
            <div class="form-group">
                <label for="password">Hasło</label>
                <input type="password" id="password" name="password" class="form-control" required autocomplete="new-password">
            </div>
            <div class="form-group">
                <label for="first_name">Imię</label>
                <input type="text" id="first_name" name="first_name" class="form-control" value="{{ first_name or '' }}" required>
            </div>
            <div class="form-group">
                <label for="last_name">Nazwisko</label>
                <input type="text" id="last_name" name="last_name" class="form-control" value="{{ last_name or '' }}" required>
            </div>
            <div class="form-group">
                <label for="phone_number">Numer telefonu</label>
                <input type="tel" id="phone_number" name="phone_number" class="form-control" value="{{ phone_number or '' }}" required>
            </div>
            <div class="form-group">
                <label for="birth_date">Data urodzenia</label>
                <input type="date" id="birth_date" name="birth_date" class="form-control" value="{{ birth_date or '' }}" required>
            </div>
            <button type="submit" class="btn btn-primary">Utwórz konto</button>
        </form>
    </section>

    <section class="auth-secondary">
        <p>Masz już konto? <a href="/login">Zaloguj się</a>.</p>
    </section>

    <footer class="auth-footer">
        <nav aria-label="Linki pomocnicze">
            <a href="#">Warunki</a>
            <a href="#">Prywatność</a>
            <a href="#">Bezpieczeństwo</a>
            <a href="/">Kontakt</a>
        </nav>
        <p>© 2025 Krakowskie Centrum Wolontariatu</p>
    </footer>
</main>
 <script>
    document.getElementById("userForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        first_name: document.getElementById("first_name").value,
        last_name: document.getElementById("last_name").value,
        password: document.getElementById("password").value,
        email: document.getElementById("email").value,
        birth_date: document.getElementById("birth_date").value,
        phone_number: document.getElementById("phone_number").value,
        user_type: document.getElementById("user_type").value
      };

      try {
        const apiBase = window.location.origin;
        const response = await fetch(`${apiBase}/users/`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        document.getElementById("result").textContent = JSON.stringify(result, null, 2);
      } catch (error) {
        document.getElementById("result").textContent = "Error: " + error;
      }
    });
  </script>
</body>
</html>
